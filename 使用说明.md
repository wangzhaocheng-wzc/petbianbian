# 宠物健康监测社区平台 - 使用说明

## 项目概述

宠物健康监测社区平台是一个集宠物健康监测、便便分析、记录追踪和社区分享于一体的综合性网站平台。该项目采用现代化的全栈技术架构，为宠物主人提供专业的健康监测服务和活跃的社区交流环境。

## 核心功能

### 🔍 便便健康检测
- **AI图像识别**: 上传宠物便便照片，AI自动分析健康状况
- **健康评估**: 提供健康/警告/异常三级评估结果
- **专业建议**: 根据分析结果给出相应的健康建议

### 📊 健康记录追踪
- **记录管理**: 完整的宠物排便记录和健康数据追踪
- **趋势分析**: 生成周/月/季度健康趋势图表
- **统计报告**: 详细的健康统计数据和异常模式识别
- **智能提醒**: 异常情况警告和定期检查提醒

### 👥 宠物社区
- **内容分享**: 发布图文帖子，分享宠物生活点滴
- **互动交流**: 点赞、评论、关注等社交功能
- **经验分享**: 与其他宠物主人交流养宠经验
- **专家咨询**: 获得专业的宠物健康建议

### 🐕 宠物管理
- **宠物档案**: 创建和管理多个宠物的详细信息
- **信息追踪**: 记录宠物的基本信息、健康状况等
- **多宠物支持**: 支持管理多只宠物的信息

## 技术架构

### 前端技术栈
- **React 18 + TypeScript**: 现代化的前端框架
- **Vite**: 快速的构建工具
- **Tailwind CSS**: 实用优先的CSS框架
- **React Router**: 客户端路由管理
- **Chart.js + Recharts**: 数据可视化图表库
- **Axios**: HTTP客户端
- **React Hook Form**: 表单处理
- **Playwright**: E2E测试框架

### 后端技术栈
- **Node.js + Express + TypeScript**: 服务端框架
- **MongoDB + Mongoose**: 数据库和ODM
- **Redis**: 缓存和会话存储
- **JWT + bcryptjs**: 身份认证和密码加密
- **Multer + Sharp**: 文件上传和图像处理
- **Winston**: 日志记录
- **Jest**: 单元测试框架

### 基础设施
- **Docker + Docker Compose**: 容器化部署
- **Nginx**: 反向代理和负载均衡
- **GitHub Actions**: CI/CD自动化
- **Kubernetes**: 容器编排（可选）

## 环境要求

### 开发环境
- Node.js 18+
- MongoDB 6.0+
- Redis 7+
- npm 或 yarn

### 生产环境
- Docker 20.10+
- Docker Compose 2.0+
- 4GB+ RAM
- 20GB+ 存储空间

## 快速启动

### 方式一：Docker 容器化部署（推荐）

1. **克隆项目**
```bash
git clone <repository-url>
cd pet
```

2. **环境配置**
```bash
# 复制环境变量模板
cp .env.example .env

# 编辑环境变量（必须配置）
# 设置JWT_SECRET、MONGO_ROOT_PASSWORD等关键配置
```

3. **启动服务**
```bash
# 开发环境
npm run docker:dev

# 生产环境
npm run docker:prod

# 查看日志
npm run docker:logs

# 停止服务
npm run docker:stop
```

### 方式二：本地开发部署

1. **安装依赖**
```bash
# 安装所有项目依赖
npm run install:all
```

2. **数据库准备**
```bash
# 启动MongoDB（需要预先安装）
mongod

# 启动Redis（需要预先安装）
redis-server

# Windows用户可以使用脚本启动Redis
start-redis.bat
```

3. **环境配置**
```bash
# 后端环境配置
cp backend/.env.example backend/.env
# 编辑 backend/.env 文件，配置数据库连接等

# 前端环境配置
cp frontend/.env.example frontend/.env
# 配置API地址等前端环境变量
```

4. **启动开发服务器**
```bash
# 同时启动前后端
npm run dev

# 或分别启动
npm run dev:frontend  # 前端: http://localhost:3000
npm run dev:backend   # 后端: http://localhost:5000
```

## 服务访问地址

### 开发环境
- **前端应用**: http://localhost:3000
- **后端API**: http://localhost:5000/api
- **健康检查**: http://localhost:5000/api/health
- **MongoDB**: localhost:27017
- **Redis**: localhost:6379

### 生产环境（Docker）
- **应用入口**: http://localhost (Nginx代理)
- **前端**: http://localhost:3000
- **后端API**: http://localhost:5000/api

## 功能使用指南

### 用户注册和登录
1. 访问前端应用首页
2. 点击"注册"按钮创建新账户
3. 填写用户名、邮箱和密码
4. 登录后即可使用所有功能

### 宠物管理
1. 登录后进入"我的宠物"页面
2. 点击"添加宠物"创建宠物档案
3. 填写宠物基本信息（姓名、品种、年龄等）
4. 可以上传宠物头像照片

### 便便健康检测
1. 进入"健康检测"页面
2. 选择要检测的宠物
3. 上传便便照片（支持拖拽上传）
4. 等待AI分析结果
5. 查看健康评估和建议

### 健康记录查看
1. 进入"健康记录"页面
2. 查看历史检测记录列表
3. 点击"统计分析"查看趋势图表
4. 可以按时间段筛选记录
5. 支持导出健康报告

### 社区互动
1. 进入"宠物社区"页面
2. 浏览其他用户分享的内容
3. 点击"发布"按钮分享自己的内容
4. 可以点赞、评论和关注其他用户

## 测试和验证

### 功能测试
```bash
# 运行综合功能测试
node test-comprehensive.js

# 运行特定功能测试
node test-pets-api.js        # 宠物管理测试
node test-community-robust.js # 社区功能测试
node test-frontend-e2e.js    # 前端E2E测试
```

### 性能测试
```bash
# 运行性能测试
node test-performance.js

# 前端性能测试
cd frontend
npm run test:e2e:performance
```

### 安全测试
```bash
# 运行安全测试
node test-security.js
```

## 部署和运维

### 生产部署
```bash
# 使用部署脚本
./scripts/deploy.sh production

# Windows用户
scripts\deploy.bat production
```

### 健康监控
```bash
# 检查系统健康状态
npm run health-check

# 查看系统日志
npm run docker:logs
```

### 数据备份
```bash
# 执行数据备份
npm run backup
```

## 开发指南

### 代码规范
```bash
# 后端代码检查
cd backend
npm run lint          # ESLint检查
npm run format        # Prettier格式化
npm run type-check    # TypeScript类型检查

# 前端代码检查
cd frontend
npm run lint
npm run format
npm run type-check
```

### 构建项目
```bash
# 构建所有项目
npm run build

# 分别构建
npm run build:frontend
npm run build:backend
```

## 故障排除

### 常见问题

1. **服务启动失败**
   - 检查端口是否被占用
   - 确认环境变量配置正确
   - 查看Docker容器日志

2. **数据库连接失败**
   - 确认MongoDB服务正在运行
   - 检查数据库连接字符串
   - 验证用户名密码配置

3. **前端无法访问后端**
   - 检查API地址配置
   - 确认CORS设置正确
   - 验证网络连接

4. **文件上传失败**
   - 检查uploads目录权限
   - 确认文件大小限制
   - 验证文件格式支持

### 日志查看
```bash
# 查看后端日志
tail -f backend/logs/app.log

# 查看Docker容器日志
docker-compose logs -f backend
docker-compose logs -f frontend
```

## 项目发展规划

### 已完成功能（第一阶段）
- ✅ 用户认证系统
- ✅ 宠物管理功能
- ✅ 基础便便分析
- ✅ 记录查看功能

### 开发中功能（第二阶段）
- 🔄 高级数据分析
- 🔄 智能提醒系统
- 🔄 改进的AI分析
- 🔄 统计图表功能

### 计划功能（第三、四阶段）
- 📋 完整社区功能
- 📋 用户等级系统
- 📋 专家咨询服务
- 📋 移动端PWA
- 📋 性能优化
- 📋 管理后台

## 技术支持

如果在使用过程中遇到问题，可以：

1. 查看项目文档和README
2. 运行测试脚本验证功能
3. 检查系统日志和错误信息
4. 参考故障排除指南

## 贡献指南

欢迎为项目贡献代码！请遵循以下步骤：

1. Fork项目仓库
2. 创建功能分支
3. 编写代码和测试
4. 提交Pull Request
5. 等待代码审查

---

**注意**: 这是一个活跃开发中的项目，功能和文档会持续更新。建议定期查看最新版本的文档和更新日志。