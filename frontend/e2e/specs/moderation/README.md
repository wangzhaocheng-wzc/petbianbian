# 内容审核测试文档

## 测试概述

本测试套件全面覆盖社区内容审核功能，包括敏感内容检测、举报处理、用户封禁和管理员审核工具等核心功能。

## 测试覆盖范围

### 1. 敏感内容检测和过滤测试 (`content-filtering.spec.ts`)

#### ✅ 文本内容检测
- 敏感词汇自动检测和阻止
- 正常内容通过验证
- 多种敏感内容类型检测
- 检测日志记录和追踪

#### ✅ 图片内容检测
- 不当图片内容识别
- 图片内容安全验证
- 图片上传安全检查

#### ✅ 内容过滤规则管理
- 敏感词汇库配置
- 过滤规则动态更新
- 白名单功能支持
- 规则优先级管理

### 2. 举报处理功能测试 (`report-handling.spec.ts`)

#### ✅ 用户举报功能
- 不当内容举报流程
- 多种举报原因分类
- 重复举报防护机制
- 举报状态通知系统

#### ✅ 举报管理和处理
- 管理员举报队列查看
- 举报优先级排序
- 批量处理举报功能
- 举报处理历史记录

#### ✅ 举报工作流程
- 举报提交到处理完整流程
- 举报状态实时更新
- 处理结果用户通知
- 举报数据统计分析

### 3. 用户封禁功能测试 (`user-banning.spec.ts`)

#### ✅ 封禁操作管理
- 临时封禁功能（1小时-30天）
- 永久封禁功能
- 封禁解除功能
- 批量封禁操作

#### ✅ 封禁权限控制
- 被封禁用户登录限制
- 被封禁用户操作限制
- 封禁状态验证
- 封禁时长管理

#### ✅ 封禁申诉系统
- 用户封禁申诉提交
- 管理员申诉审核
- 申诉处理流程
- 申诉结果通知

#### ✅ 封禁记录管理
- 封禁历史记录
- 封禁原因追踪
- 封禁统计分析
- 封禁数据导出

### 4. 管理员审核工具测试 (`admin-moderation.spec.ts`)

#### ✅ 审核仪表板
- 待审核内容队列
- 审核统计数据展示
- 快速操作工具
- 审核进度监控

#### ✅ 审核决策工具
- 内容审核批准/拒绝
- 批量审核操作
- 审核备注和理由
- 审核决策记录

#### ✅ 审核规则配置
- 自动审核规则设置
- 审核流程自定义
- 审核权限管理
- 审核模板管理

#### ✅ 审核分析和报告
- 审核效率统计
- 审核质量分析
- 趋势数据报告
- 审核日志查询

### 5. 完整审核流程测试 (`moderation-workflow.spec.ts`)

#### ✅ 端到端审核流程
- 从内容发布到处理的完整流程
- 多用户角色协作测试
- 审核决策执行验证
- 处理结果反馈确认

#### ✅ 批量处理工作流程
- 多个违规内容批量处理
- 重复违规用户处理
- 批量操作效率验证
- 处理结果统计分析

#### ✅ 紧急审核模式
- 紧急情况快速响应
- 紧急举报优先处理
- 紧急封禁操作
- 紧急模式状态管理

#### ✅ 跨平台内容同步
- 多平台违规内容检测
- 跨平台内容统一处理
- 同步审核决策执行
- 跨平台数据一致性

#### ✅ 审核申诉和复审
- 审核决策申诉流程
- 高级管理员复审
- 申诉处理结果执行
- 复审决策记录

#### ✅ 自动化与人工审核结合
- 自动审核规则配置
- 边缘案例人工审核
- 自动化审核效果验证
- 人工审核质量保证

## 测试数据管理

### 测试用户角色
- **普通用户**: 用于基本举报和申诉操作
- **违规用户**: 用于创建违规内容和测试封禁
- **管理员用户**: 用于审核操作和管理功能
- **高级管理员**: 用于复审和高级管理功能

### 测试内容类型
- **正常内容**: 符合社区规定的内容
- **敏感内容**: 包含敏感词汇的内容
- **垃圾内容**: 广告推广类违规内容
- **骚扰内容**: 恶意骚扰和攻击性内容

### 测试场景数据
- **举报原因**: 垃圾信息、不当内容、骚扰行为、虚假信息等
- **封禁时长**: 1小时、24小时、7天、30天、永久
- **审核决策**: 批准、拒绝、需要更多信息
- **申诉类型**: 误判申诉、情况说明、证据补充

## 运行测试

### 运行所有审核测试
```bash
node frontend/e2e/run-moderation-tests.cjs
```

### 运行特定测试模块
```bash
# 敏感内容检测测试
node frontend/e2e/run-moderation-tests.cjs filtering

# 举报处理测试
node frontend/e2e/run-moderation-tests.cjs reporting

# 用户封禁测试
node frontend/e2e/run-moderation-tests.cjs banning

# 管理员工具测试
node frontend/e2e/run-moderation-tests.cjs admin

# 完整流程测试
node frontend/e2e/run-moderation-tests.cjs workflow
```

### 查看可用测试
```bash
node frontend/e2e/run-moderation-tests.cjs --list
```

## 测试环境要求

### 前置条件
- 用户认证系统正常运行
- 社区功能模块已启用
- 内容审核API服务可用
- 管理员权限配置正确

### 数据清理
- 每个测试用例后自动清理创建的内容
- 清理测试用户的封禁状态
- 重置审核规则配置
- 清理举报和申诉记录

## 测试配置

### 超时设置
- 单个测试用例超时: 60秒
- 页面加载超时: 30秒
- API响应超时: 10秒
- 元素等待超时: 5秒

### 重试策略
- 失败测试重试次数: 2次
- 网络错误重试间隔: 1秒
- 元素查找重试次数: 3次

### 并发设置
- 并发测试进程数: 2个
- 浏览器实例复用: 启用
- 测试数据隔离: 启用

## 已知问题和限制

### 当前限制
- 某些敏感内容检测依赖外部AI服务
- 跨平台内容同步可能有延迟
- 批量操作在大数据量时性能影响

### 待改进项
- 增加更多边界条件测试
- 完善性能压力测试
- 添加可访问性审核测试
- 增强错误恢复机制测试

## 测试报告

测试完成后会生成详细的HTML报告，包括：
- 各模块测试执行结果
- 失败用例的详细信息和截图
- 审核功能覆盖率统计
- 性能指标和响应时间分析
- 测试数据和环境信息

报告位置：`frontend/e2e/test-results/moderation/index.html`

## 质量保证

### 测试质量标准
- 所有核心审核功能100%覆盖
- 关键用户路径端到端验证
- 异常情况和边界条件处理
- 多用户角色权限验证

### 持续集成
- 每次代码提交自动运行核心测试
- 每日完整测试套件执行
- 测试失败自动通知相关人员
- 测试报告自动归档和分析