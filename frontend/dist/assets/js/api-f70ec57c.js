import{a as e}from"./utils-2ce30174.js";const t="http://localhost:5000/api",r="access_token",a="refresh_token",o=e=>{try{return localStorage.getItem(e)}catch{return null}},s=(e,t)=>{try{localStorage.setItem(e,t)}catch{}},n=e=>{try{localStorage.removeItem(e)}catch{}},c=()=>o(r),i=e=>s(r,e),h=()=>o(a),l=()=>{n(r),n(a)},u=e.create({baseURL:t,timeout:1e4,headers:{"Content-Type":"application/json"}});u.interceptors.request.use(e=>{const t=c();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),u.interceptors.response.use(e=>e,async r=>{var a;const o=r.config;if(401===(null==(a=r.response)?void 0:a.status)&&!o._retry){o._retry=!0;const r=h();if(r)try{const a=await e.post(`${t}/auth/refresh`,{refreshToken:r}),{accessToken:s}=a.data.data;return i(s),o.headers.Authorization=`Bearer ${s}`,u(o)}catch(s){return l(),window.location.href="/login",Promise.reject(s)}else window.location.href="/login"}return Promise.reject(r)});const p={get:(e,t)=>u.get(e,t).then(e=>e.data),post:(e,t,r)=>u.post(e,t,r).then(e=>e.data),put:(e,t,r)=>u.put(e,t,r).then(e=>e.data),delete:(e,t)=>u.delete(e,t).then(e=>e.data),patch:(e,t,r)=>u.patch(e,t,r).then(e=>e.data)};export{u as a,p as b};
