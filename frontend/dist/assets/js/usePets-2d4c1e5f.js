import{r as e}from"./react-vendor-7927b0b6.js";import{b as a}from"./api-f70ec57c.js";const s=async()=>a.get("/pets"),t=async e=>a.post("/pets",e),n=async(e,s)=>a.put(`/pets/${e}`,s),r=async e=>a.delete(`/pets/${e}`),l=()=>{const[a,l]=e.useState([]),[c,u]=e.useState(!1),[o,d]=e.useState(null),i=async()=>{var e,a;try{u(!0),d(null);const e=await s();e.success&&e.data?l(e.data.pets):d(e.message||"获取宠物列表失败")}catch(t){d((null==(a=null==(e=t.response)?void 0:e.data)?void 0:a.message)||"获取宠物列表失败")}finally{u(!1)}};return e.useEffect(()=>{i()},[]),{pets:a,loading:c,error:o,fetchPets:i,createPet:async e=>{var a,s;try{u(!0),d(null);const a=await t(e);return a.success&&a.data?(l(e=>[a.data,...e]),!0):(d(a.message||"创建宠物失败"),!1)}catch(n){return d((null==(s=null==(a=n.response)?void 0:a.data)?void 0:s.message)||"创建宠物失败"),!1}finally{u(!1)}},updatePet:async(e,a)=>{var s,t;try{u(!0),d(null);const s=await n(e,a);return s.success&&s.data?(l(a=>a.map(a=>a.id===e?s.data:a)),!0):(d(s.message||"更新宠物失败"),!1)}catch(r){return d((null==(t=null==(s=r.response)?void 0:s.data)?void 0:t.message)||"更新宠物失败"),!1}finally{u(!1)}},deletePet:async e=>{var a,s;try{u(!0),d(null);const a=await r(e);return a.success?(l(a=>a.filter(a=>a.id!==e)),!0):(d(a.message||"删除宠物失败"),!1)}catch(t){return d((null==(s=null==(a=t.response)?void 0:a.data)?void 0:s.message)||"删除宠物失败"),!1}finally{u(!1)}},clearError:()=>d(null)}};export{l as u};
